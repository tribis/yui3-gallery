YUI.add("gallery-inline-xhr",function(e){var F="inlineXHR",o={mode:null,url:null,method:"POST"},r={},a=0,f="Executing",C="method",z="ResponseText",H="undefined",E=" ",l="#",v="is empty",i="in",n="error",g="info",w="alert",k="not found",x="HTML",m="cursor",y="JSON syntax error in responseText: ",d=function(I,J){if(J===n&&o.mode===w){window.alert(I);}},B=function(L,J,I,K){if(e[L]===undefined){return false;}else{d(f+E+C+" of Y : "+L,g);J.push(I,K);e[L].apply(e,J);return true;}},p=function(L,J,I,K){if(r===undefined){return false;}if(r[L]!==undefined){d(f+" private"+E+C+" : "+L,g);J.push(I,K);r[L].apply(r,J);return true;}else{return false;}},c=function(J,I){d("Error response received from server: "+J+": "+I,n);},j=function(R,K){if(K.responseText!==undefined){if(K.responseText.length===0){d(z+E+v+".",n);return;}try{var L=e.JSON.parse(K.responseText),Q,I,M,J,N,P;if(L.c!==200){Q=L.c;I=L.t;c(Q,I);}else{try{for(M in L.ff){if(L.ff.hasOwnProperty(M)){J=L.ff[M];N=J.f;P=J.a;if(!B(N,P,R,K)){if(!p(N,P,R,K)){d(C+" '"+N+"' "+k+" in Y or "+F,n);}}}}}catch(O){d(n+E+O,n);return;}}}catch(O){d(y+K.responseText+E+i+E+F+" "+O,n);return;}}else{d(z+E+H+E+i+E+F,n);}},s=function(){a++;},G=function(){a--;},t=function(){return a;},A=function(){s();e.one(x).setStyle(m,"wait");e.all("input").each(function(I){I.setStyle(m,"wait");});},D=function(){G();if(0===t()){e.one(x).setStyle(m,"default");e.all("input").each(function(I){I.setStyle(m,"default");});}},b=function(I,K){var J="Failure for xhr Id: "+I+".\n";J+="HTTP status: "+K.status+"\n";J+="HTTP headers received: "+K.getAllResponseHeaders()+"\n";J+="Status code message: "+K.statusText+".";d(J,n);},h=function(){var I;for(I in this){if(this.hasOwnProperty(I)&&I!=="request"){this[I]();}}},q=function(I){I=I||{};if(undefined===I.request){I.request=h;}return I;},u=function(){u.superclass.constructor.apply(this,arguments);};u.NAME=F;e.extend(u,e.Base,{register:function(L,K,J,M){var I=this;L=q(L);L[K]=function(){o.url=o.url?o.url:document.location.href.replace(document.location.hash,"");var O=null,N;if(M!==undefined){O={id:e.one(M),useDisabled:false};}N=e.io(o.url,{method:o.method,data:J+"&ajaxAction="+K,form:O,on:{success:j,failure:b,start:A,complete:D,end:e.bind(I._onEnd,I)},arguments:{end:K}});};return L;},_getEndCb:function(I){return this._endCallBacks.funcs[I];},_getEndCbArgs:function(I){return this._endCallBacks.args[I];},_getEndCbContext:function(I){return this._endCallBacks.contexts[I];},_onEnd:function(){var L=arguments[1].end,K=this._getEndCb(L),I=this._getEndCbArgs(L),J=this._getEndCbContext(L)||this;if(e.Lang.isFunction(K)){this._endCallBacks.results[L]=K.apply(J,I);}},_endCallBacks:{args:{},funcs:{},contexts:{},results:{}},_clearEndCallBack:function(I){this._endCallBacks.contexts[I]=null;this._endCallBacks.funcs[I]=null;this._endCallBacks.args[I]=null;this._endCallBacks.results[I]=null;},after:function(K,J){var I=e.Array(arguments);if(I.length<2){d("Missing mandatory arguments to inlineXHR::after."+K,n);}I.splice(0,2);var L=I.shift();this._endCallBacks.contexts[K]=L;this._endCallBacks.funcs[K]=J;this._endCallBacks.args[K]=I;},getAfter:function(J){var I=this._endCallBacks.results[J];this._clearEndCallBack(J);return I;},wizard:function(L){var N=L.fnName,J=L.tag,M,I=L.start?L.start:this.getAfter(N),K=[M,N,I],O=L.formId?l+L.formId:null;if(O){K.push(O);}M=this.register.apply(this,K);if(J){this.after(N,function(P){I=e.one(l+P).get("value");return I;},this,J);}return M;},header:function(I,J){e.io.header.apply(e,arguments);},usePrivate:function(J,I){r[I]=J;d("Registering for use private func: "+I+" on inlinexhr object.",g);},setConfig:function(J){var I;for(I in J){if(J.hasOwnProperty(I)){if(o[I]===undefined){d("Wrong configuration parameter passed to xhr object: "+I,n);}d("Setting : '"+I+"' to '"+J[I]+"'",g);o[I]=J[I];}}},startSpinner:function(){e.one(x).setStyle(m,"wait");},stopSpinner:function(){if(0===t()){e.one(x).setStyle(m,"default");}},bind:function(I,J){var L,K;if(J){d("Binding selected methods: "+J,g);for(K=0;K<J.length;K++){L=J[K];if(e.Lang.isFunction(I[L])){this.usePrivate(e.bind(I[L],I),L);}else{d("Wrong argument passed to inlineXHR::bind: "+L,n);}}}else{for(K in I){if(0!==K.indexOf("_")){this.usePrivate(I[K],K);}}}if(e.dump){d("Dumping clientMethods: "+e.dump(r),g);}}});e.Base.InlineXhr=u;},"@VERSION@",{optional:["io-form"],requires:["json-parse","node","io-base","base"]});